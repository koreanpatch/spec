lexicon: 1
id: tools.spec.oauth.defs
description: Shared type definitions for SPEC OAuth endpoints.
defs:
  tokenResponse:
    type: object
    required:
      - access_token
      - token_type
      - expires_in
      - sub
      - scope
    properties:
      access_token:
        type: string
      token_type:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      scope:
        type: string
      sub:
        type: string
        format: did

  tokenRequest:
    type: object
    required:
      - grant_type
    properties:
      grant_type:
        type: string
        enum:
          - authorization_code
          - refresh_token
      code:
        type: string
      redirect_uri:
        type: string
        format: uri
      code_verifier:
        type: string
      refresh_token:
        type: string
      client_id:
        type: string
        format: uri

  parRequest:
    type: object
    required:
      - client_id
      - redirect_uri
      - response_type
      - code_challenge
      - code_challenge_method
      - scope
      - state
    properties:
      client_id:
        type: string
        format: uri
      redirect_uri:
        type: string
        format: uri
      response_type:
        type: string
        enum:
          - code
      code_challenge:
        type: string
      code_challenge_method:
        type: string
        enum:
          - S256
      scope:
        type: string
      state:
        type: string
      login_hint:
        type: string

  parResponse:
    type: object
    required:
      - request_uri
      - expires_in
    properties:
      request_uri:
        type: string
      expires_in:
        type: integer

  introspectionResponse:
    type: object
    required:
      - active
    properties:
      active:
        type: boolean
      scope:
        type: string
      client_id:
        type: string
        format: uri
      sub:
        type: string
        format: did
      exp:
        type: integer
      iat:
        type: integer
      token_type:
        type: string

  oauthError:
    type: object
    required:
      - error
    properties:
      error:
        type: string
      error_description:
        type: string

  serverMetadata:
    type: object
    required:
      - issuer
      - authorization_endpoint
      - token_endpoint
      - pushed_authorization_request_endpoint
      - response_types_supported
      - grant_types_supported
      - code_challenge_methods_supported
      - token_endpoint_auth_methods_supported
      - token_endpoint_auth_signing_alg_values_supported
      - scopes_supported
      - dpop_signing_alg_values_supported
    properties:
      issuer:
        type: string
        format: uri
      authorization_endpoint:
        type: string
        format: uri
      token_endpoint:
        type: string
        format: uri
      pushed_authorization_request_endpoint:
        type: string
        format: uri
      introspection_endpoint:
        type: string
        format: uri
      response_types_supported:
        type: array
        items:
          type: string
      grant_types_supported:
        type: array
        items:
          type: string
      code_challenge_methods_supported:
        type: array
        items:
          type: string
      token_endpoint_auth_methods_supported:
        type: array
        items:
          type: string
      token_endpoint_auth_signing_alg_values_supported:
        type: array
        items:
          type: string
      scopes_supported:
        type: array
        items:
          type: string
      dpop_signing_alg_values_supported:
        type: array
        items:
          type: string
      authorization_response_iss_parameter_supported:
        type: boolean
      require_pushed_authorization_requests:
        type: boolean
      client_id_metadata_document_supported:
        type: boolean
